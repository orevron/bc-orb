# How to author commands: https://circleci.com/docs/2.0/reusing-config/#authoring-reusable-commands
description: >
  run checkov scan on directory
parameters:
  directory:
    description: "IaC root directory"
    type: string
    default: "none"
  file:
    description: "IaC file"
    type: string
    default: "none"
  output:
    description: "Report output format"
    type: enum
    enum: ["json", "cli", "junitxml"]
    default: "cli"
  suppress:
    description: "Runs checks but suppresses error code"
    type: boolean
    default: false
steps:
  - run:
      name: Checkov
      command: |
        SUPPRESS=<<parameters.suppress>>
        OUTPUT=<<parameters.output>>
        DIRECTORY=<<parameters.directory>>
        FILE=<<parameters.file>>
        echo SUPPRESS=$SUPPRESS
        echo OUTPUT=$OUTPUT
        echo DIRECTORY=$DIRECTORY
        echo FILE=$FILE
#        checkov -s << parameters.suppress >> -o << parameters.output >> -d << parameters.directory >>
